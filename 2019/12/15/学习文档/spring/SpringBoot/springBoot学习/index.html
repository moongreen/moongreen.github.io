<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="一、异常处理与单元测试1、异常处理​            1.1springboot对于异常处理提供的5种方式 ​                1.1.1自定义错误页面 ​                    springboot默认的处理异常的机制：异常时向/error发送请求。（BasicErrorController处理/error） ​                    自定义：">
<meta property="og:type" content="article">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/2019/12/15/学习文档/spring/SpringBoot/springBoot学习/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="一、异常处理与单元测试1、异常处理​            1.1springboot对于异常处理提供的5种方式 ​                1.1.1自定义错误页面 ​                    springboot默认的处理异常的机制：异常时向/error发送请求。（BasicErrorController处理/error） ​                    自定义：">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-12-11T11:35:15.046Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
<meta name="twitter:description" content="一、异常处理与单元测试1、异常处理​            1.1springboot对于异常处理提供的5种方式 ​                1.1.1自定义错误页面 ​                    springboot默认的处理异常的机制：异常时向/error发送请求。（BasicErrorController处理/error） ​                    自定义：">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>
</html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-学习文档/spring/SpringBoot/springBoot学习" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/15/学习文档/spring/SpringBoot/springBoot学习/" class="article-date">
  <time datetime="2019-12-15T05:32:18.588Z" itemprop="datePublished">2019-12-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="一、异常处理与单元测试"><a href="#一、异常处理与单元测试" class="headerlink" title="一、异常处理与单元测试"></a>一、异常处理与单元测试</h3><h4 id="1、异常处理"><a href="#1、异常处理" class="headerlink" title="1、异常处理"></a>1、异常处理</h4><p>​            1.1springboot对于异常处理提供的5种方式</p>
<p>​                1.1.1自定义错误页面</p>
<p>​                    springboot默认的处理异常的机制：异常时向/error发送请求。（BasicErrorController处理/error）</p>
<p>​                    自定义：1、创建一个名为error.html（必须叫error）页面  2、timestamp、status、error、message、path可以直接获取异常信息 3、所有异常将调到该页面</p>
<p>​                1.1.2@ExceptionHandle注解处理异常</p>
<p>​                    @ExceptionHandle(value={处理异常的类.class})</p>
<p>​                    ModelAndView method(Exception e){};</p>
<p>​                    不具备跨controller的能力</p>
<p>​                                1.1.3@ControllerAdvice+@ExceptionHandler注解处理异常</p>
<p>​                    全局处理异常</p>
<p>​                    </p>
<p>​                                1.1.4配置SimpleMappingExceptionResolver处理异常</p>
<p>​                    简化@ExceptionHandler（多个简化为一个方法）</p>
<p>​                    配置类@Configuration</p>
<p>​                    添加method 返回值必须是 SimpleMappingExceptionResolver</p>
<p>​                    只能创建映射但是不能传递异常信息</p>
<p>​                    /**</p>
<p>​                    * 通过 SimpleMappingExceptionResolver 做全局异常处理 </p>
<p>​                    *</p>
<p>​                    *</p>
<p>​                    */ </p>
<p>​                    @Configuration </p>
<p>​                    public class** GlobalException { </p>
<p>​                    /**</p>
<p>​                    * 该方法必须要有返回值。返回值类型必须是： </p>
<p>​                        SimpleMappingExceptionResolver </p>
<p>​                    */ </p>
<p>​                    @Bean </p>
<p>​                    public SimpleMappingExceptionResolver getSimpleMappingExceptionResolver(){ </p>
<p>​                        SimpleMappingExceptionResolver resolver = <strong>new</strong> </p>
<p>​                        SimpleMappingExceptionResolver(); </p>
<p>​                        Properties mappings = <strong>new</strong> Properties(); </p>
<p>​                        /**</p>
<p>​                            * 参数一：异常的类型，注意必须是异常类型的全名 </p>
<p>​                            * 参数二：视图名称 </p>
<p>​                        */ </p>
<p>​                        mappings.put(“java.lang.ArithmeticException”, “error1”); </p>
<p>​                        mappings.put(“java.lang.NullPointerException”,”error2”); </p>
<p>​                        //设置异常与视图映射信息的 </p>
<p>​                        resolver.setExceptionMappings(mappings); </p>
<p>​                        <strong>return</strong> resolver; </p>
<p>​                         } </p>
<p>​                }</p>
<p>​                1.1.5自定义HandleExceptionResolver类处理异常</p>
<p>​                    实现HandleExceptionResolver接口 </p>
<p>​                    resolveException(request,response,e)</p>
<h3 id="2、单元测试"><a href="#2、单元测试" class="headerlink" title="2、单元测试"></a>2、单元测试</h3><p>​    2.1测试启动类 </p>
<p>​        2.1.1@RunWith(SpringJUnit4ClassRunner.class) 启动器 （juint与spring环境进行整合） 或者子类 SpringRunner.class</p>
<p>​        2.1.2@SpringBootTest(classes={App.class}) 1、当前类为springboot的测试类 2、加载SpringBoot启动类，启动springboot</p>
<p>​        2.1.3 等价于2.1.2   junit与spring整合@Contextconfiguartion（classpath:application.yml）</p>
<h3 id="二、Springboot热部署"><a href="#二、Springboot热部署" class="headerlink" title="二、Springboot热部署"></a>二、Springboot热部署</h3><p>两种方式：</p>
<h4 id="1、springLoader"><a href="#1、springLoader" class="headerlink" title="1、springLoader"></a>1、springLoader</h4><!-- springloader 插件 --> 

<build> 

<p><plugins><plugin> </plugin></plugins></p>
<p><groupid>org.springframework.boot</groupid> </p>
<p><artifactid>spring-boot-maven-plugin</artifactid> </p>
<dependencies> 

<dependency> 

<p><groupid>org.springframework</groupid> </p>
<p><artifactid>springloaded</artifactid> </p>
<p><version>1.2.5.RELEASE</version> </p>
</dependency> 

</dependencies> 

 

 

</build>



<p>需要使用spring-boot：run启动项目</p>
<p>SpringLoader 缺陷：就是 Java 代码做部署处理。但是对页面无能为力。</p>
<p><strong>注意：这种方式的缺点是</strong> <strong>Springloader</strong> 热部署程序是在系统后台以进程的形式来运行。*需要手动关闭该进程</p>
<p>直接使用springLoader架包</p>
<h4 id="2、DevTools工具"><a href="#2、DevTools工具" class="headerlink" title="2、DevTools工具"></a>2、DevTools工具</h4><p>与springLoader的区别</p>
<p>springLoader：在部署时使用的是<strong>热部署</strong>的方式</p>
<p>DevTools：在部署时使用<strong>重新部署</strong>的放肆</p>
<h3 id="三、整合缓冲技术"><a href="#三、整合缓冲技术" class="headerlink" title="三、整合缓冲技术"></a>三、整合缓冲技术</h3><h4 id="1、Ehcache"><a href="#1、Ehcache" class="headerlink" title="1、Ehcache"></a>1、Ehcache</h4><h5 id="pom-xml"><a href="#pom-xml" class="headerlink" title="pom.xml"></a>pom.xml</h5><p>开启支持缓冲的启动器spring-boot-stater-cache</p>
<p>Ehcache坐标</p>
<p>在ehcahe架包内 ehcahe-failsafe.xml 内的xml内容移植到自己创建的ehcache.xml文件内</p>
<p>&lt;defaultCache   //默认缓冲策略</p>
<p>​    maxElementInMemory=”10000” // </p>
<p>​    eternal=”false”</p>
<p>​    timeToIdleSeconds=”120”</p>
<p>​    timeToLiveSeconds=”120”</p>
<p>​    maxElementsOnDisk=”10000000”</p>
<p>​    diskExpiryThreadIntervalSeconds=”120”</p>
<p>​    memoryStoreEvictionPolicy=”LRU”&gt;</p>
<p><cache></cache> //自定义缓冲策略</p>
<h5 id="application-yml"><a href="#application-yml" class="headerlink" title="application.yml"></a>application.yml</h5><p>spring.cache.ehcache.cofnig=ehcache.xml</p>
<h5 id="启动类"><a href="#启动类" class="headerlink" title="启动类"></a>启动类</h5><p>@EnableCaching</p>
<h5 id="业务层"><a href="#业务层" class="headerlink" title="业务层"></a>业务层</h5><p>@Cacheable(value=”users”) 当前查询的对象开启缓冲</p>
<h5 id="实体类users"><a href="#实体类users" class="headerlink" title="实体类users"></a>实体类users</h5><p>实现serializable可序列化接口</p>
<h4 id="2、-Cacheable"><a href="#2、-Cacheable" class="headerlink" title="2、@Cacheable"></a>2、@Cacheable</h4><p>参数一 value 指定一个 Ehcache 配置文件中的缓存策略，如果么有给定 value，name 则 </p>
<p>表示使用默认的缓存策略。</p>
<p>参数二 key <code>#object</code> 给存储的值起个名称。在查询时如果有名称相同的，那么则知己从缓存中将 </p>
<p>数据返回</p>
<p><strong>未加#时</strong>需要注意的是，@Cacheable注解中的key属性除了需要被英文双引号引用外，还需要加入英文单引号，否则系统在执行缓存操作时将出错。</p>
<h4 id="3、-CacheEvict"><a href="#3、-CacheEvict" class="headerlink" title="3、@CacheEvict"></a>3、@CacheEvict</h4><p>作用：清除缓冲</p>
<p>参数一 value </p>
<p>参数二 allEntrues=true  //@CacheEvict(value=”users”,allEntries=true) 清除缓存中以 users 缓存策略缓存的对象 </p>
<h1 id="三-、缓冲技术–redis"><a href="#三-、缓冲技术–redis" class="headerlink" title="三 、缓冲技术–redis"></a>三 、缓冲技术–redis</h1><p>添加spring data-redis 依赖</p>
<p>完成 对Redis的整合的一些配置</p>
<p>@Configuration//配置类</p>
<p>@Bean JedisPoolConfig对象 连接池</p>
<p>new –》 config.setMaxIdle(20)//最大空闲数   setMinIdle(10) 最小  setMaxTotal(20) 最大连接数</p>
<p>@Bean JedisConnectionFactory 配置redis链接信息  hostname port poolconfig</p>
<p>@Bean RedisTemplate 用于执行Redis操作的方法     connctionFactory    key序列化器 value 序列化器</p>
<h1 id="四、Spring-data-JPA"><a href="#四、Spring-data-JPA" class="headerlink" title="四、Spring-data JPA"></a>四、Spring-data JPA</h1><h4 id="一、spring-Data-JPA介绍"><a href="#一、spring-Data-JPA介绍" class="headerlink" title="一、spring Data JPA介绍"></a>一、spring Data JPA介绍</h4><p>spring data:其实spring data就是spring提供了一个操作数据的框架。而spring data JPA 只是spring data框架下的一个基于JPA的标准操作数据的模块。</p>
<p>spring data jpa:基于jpa的标准对数据进行操作。简化操作持久层的代码。只需要缩写接口就可以</p>
<h4 id="二、spring-boot-整合spring-jpa"><a href="#二、spring-boot-整合spring-jpa" class="headerlink" title="二、spring boot 整合spring jpa"></a>二、spring boot 整合spring jpa</h4><p>1、搭建环境</p>
<p>data-jpa 架包</p>
<p>2、dao层</p>
<p>定义接口 继承JpaRepository&lt;T,T1&gt;</p>
<p>T:当前需要映射的实体</p>
<p>T1:当前映射的实体中的OID的类型</p>
<h4 id="三、spring-data-jpa-提供核心接口"><a href="#三、spring-data-jpa-提供核心接口" class="headerlink" title="三、spring data jpa 提供核心接口"></a>三、spring data jpa 提供核心接口</h4><h5 id="1、repository-lt-T-T1-gt"><a href="#1、repository-lt-T-T1-gt" class="headerlink" title="1、repository&lt;T,T1&gt;"></a>1、repository&lt;T,T1&gt;</h5><h6 id="1-1提供了方法名称命名查询方式"><a href="#1-1提供了方法名称命名查询方式" class="headerlink" title="1.1提供了方法名称命名查询方式"></a>1.1提供了方法名称命名查询方式</h6><p>方法的名称必须遵循驼峰命名规则，findBy（关键字）+属性名称（首字母大写）（查询条件（首字母小写） ）返回List</p>
<p>and  findBy（关键字）+属性名称（首字母大写）+And(关键字)+属性名称（首字母大写）（多个属性名称）</p>
<p>or    同上</p>
<p>like findBy（关键字）+属性名称（首字母大写）+Like(关键字) (属性名称+注意加通配符%)</p>
<h6 id="1-2提供了基于-Query注解查询与更新"><a href="#1-2提供了基于-Query注解查询与更新" class="headerlink" title="1.2提供了基于@Query注解查询与更新"></a>1.2提供了基于@Query注解查询与更新</h6><p>@Query(“from Student where name=?”)// Student  实体名  nativeQuery 默认为false</p>
<p>@Query(value=”select * from student where name=?”,nativeQuery=true) // nativeQuery 是否标准的sql语句</p>
<p>@Query + @Modifying(只执行更新操作)</p>
<p>(@Test +@Transactional 一起使用时事务会自动回滚 必须再加上@Rollback(false) 取消自动回滚)</p>
<p>2、CrudRepository</p>
<p>对数据进行增删改查的操作。注意：该接口继承了Repository接口</p>
<p>3、PagingAndSortingRepository</p>
<p>提供了分页与排序的功能 注意：该接口继承了CrudRepository接口</p>
<p>方法（不能带有条件的查询）</p>
<p>4、JpaRepository</p>
<p>该接口继承了PagingAndSortingRepository接口。对继承的父类接口方法返回值的适配</p>
<p>5、JPASpecificationExecutor</p>
<p>多条件查询的支持（可添加分页与排序）</p>
<p>注意：单独存在（没有继承上几个接口）</p>
<p>Specification<t>(){</t></p>
<p>​    Predicate:封装了单个查询条件</p>
<p>​    Root<t> 查询对象的属性的封装</t></p>
<p>​    CriteriaQuert&lt;?&gt; query：封装了我们要执行的查询各个部分的信息select from order by</p>
<p>​    CriteriaBuilder cb 查询条件的构造器。定义不同的查询条件</p>
<p>​    public  Predicate toPredicate(Root<t> root,CriteriaQuert&lt;?&gt; query,CriteriaBuilder cb){</t></p>
<p>​    }</p>
<p>}</p>
<h4 id="四、关联映射操作"><a href="#四、关联映射操作" class="headerlink" title="四、关联映射操作"></a>四、关联映射操作</h4><p>1、 一对多的关联关系</p>
<p>@ManyToOne 多对一</p>
<p>@JoinColumn（name=“外键ID”）:维护外键</p>
<p>@OneToMany 一对多</p>
<p>2、多对多关联关系</p>
<p>@ManyToMany</p>
<p>@JoinTable（name=“中间表名”，joinColumns=@JoinColumn(name=”当前表中的主键所关联的中间表中的外键字段”)，inverseJoinColums=@JoinColumn(name=”关联表另一张表的外键”)）:映射中间表</p>
<p>@ManyToMany（mappedBy=”关联的另一张表的映射属性”）</p>
<h1 id="五、SpringBoot-定时任务"><a href="#五、SpringBoot-定时任务" class="headerlink" title="五、SpringBoot 定时任务"></a>五、SpringBoot 定时任务</h1><p>一、一、Scheduled定时任务器</p>
<p>​    Scheduled定时任务器：是Spring3.0以后自带的一个定时任务器</p>
<p>添加Scheduled架包 spring-context-support</p>
<p>@Component（类）</p>
<p>@Scheduled （cron=”cron属性：cron表达式。定时任务触发是时间的一个字符串表达形式”）:设置定时任务（方法）</p>
<p>cron表达式：</p>
<p>1、六个域表达式 0/2 * * * * *</p>
<p>启动类开启@EnableScheduling</p>
<p>一、二、整合Quartz定时任务器</p>
<p>java开发的</p>
<p>Quartz 的使用思路</p>
<p>1）job 任务-你要做什么事？</p>
<p>2）Trigger-触发器 你什么时候做？</p>
<p>3）Scheduler-任务调度 你什么时候需要去作什么？参数（job,Trigger）</p>
<p>SoringBoot整合添加</p>
<p>quartz架包</p>
<p>spring-context-support</p>
<p>Spring-tx 事务架包</p>
<p>@configuration 配置类</p>
<p>@Bean</p>
<p>JobDetailFactory</p>
<p>1、关联自己的job类（实现job接口）</p>
<p>@Bean</p>
<p>SimpleTriggerFactoryBean（JobDetailFactory）或者cronTriggerFactoryBean(JobDetailFactory)</p>
<p>1、关联JobDetail对象</p>
<p>2、该参数表示一个执行的毫秒数</p>
<p>3、重复次数</p>
<p>@Bean</p>
<p>SchedulerFactory Bean (SimpleTriggerFactoryBean)</p>
<p>启动类开启@EnableScheduling</p>
<p>注意可以使用：cron表达式</p>
<p>@Component</p>
<p>@autowired</p>
<p>AutowireCapableBeanFactory 可以将一个对象添加到springIoc容器中</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2019/12/15/学习文档/spring/SpringBoot/springBoot学习/" data-id="ck46kswfo000h64ssfrx48chq" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/12/15/学习文档/spring/SpringBoot/springboot注解/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          (no title)
        
      </div>
    </a>
  
  
    <a href="/2019/12/15/学习文档/spring/SpringBoot/idea-springboot学习/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">July 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/12/15/raids/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/12/15/学习文档/项目管理/github/github学习/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/12/15/学习文档/项目管理/git/idea-git配置/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/12/15/学习文档/项目管理/git/git学习文档/">(no title)</a>
          </li>
        
          <li>
            <a href="/2019/12/15/学习文档/框架/SOA架构和微服务架构的区别/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>